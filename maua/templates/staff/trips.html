{% extends 'staff/_layout.html' %}
{% block staff_content %}
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2 class="mb-0">Trips</h2>
    <a class="btn btn-primary" href="{{ url_for('staff.trips_create') }}"><i class="fas fa-plus me-1"></i>Create Trip</a>
  </div>
  <table class="table">
    <thead>
      <tr>
        <th>ID</th><th>Vehicle</th><th>Route</th><th>Departs</th><th>Status</th><th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for t in trips %}
      <tr>
        <td>{{ t.id }}</td>
        <td>{{ t.vehicle.plate_no }}</td>
        <td>{{ t.route.origin.town }} â†’ {{ t.route.destination.town }}</td>
        <td>{{ t.depart_at.strftime('%Y-%m-%d %H:%M') }}</td>
        <td>{{ t.status }}</td>
        <td>
          <form method="post" action="{{ url_for('staff.trips_update_status', trip_id=t.id) }}">
            <select name="status">
              {% for s in ['scheduled','in_progress','completed','cancelled'] %}
              <option value="{{ s }}" {% if t.status==s %}selected{% endif %}>{{ s }}</option>
              {% endfor %}
            </select>
            <button class="btn btn-sm btn-success">Update</button>
            <a class="btn btn-sm btn-outline-primary" href="{{ url_for('catalog.trip_detail', trip_id=t.id) }}">View</a>
            <a class="btn btn-sm btn-dark" href="{{ url_for('staff.trip_seat_map', trip_id=t.id) }}">Seat map</a>
          </form>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
{% endblock %}


